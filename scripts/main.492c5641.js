(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;g=/\D+|\d+(\.\d+)?[ETGMkmμnpf]?/g,o=function(a,b){var c,d,e,f,h,j,k,l;for(h=(a+"").match(g),j=(b+"").match(g),d=k=0,l=Math.min(h.length,j.length);l>=0?l>k:k>l;d=l>=0?++k:--k)if(isNaN(parseInt(h[d]))||isNaN(parseInt(j[d]))){if(e=h[d].toUpperCase(),f=j[d].toUpperCase(),f>e)return-1;if(e>f)return 1}else if(c=i(h[d])-i(j[d]),0!==c)return c;return h.length-j.length},j=function(a,b){return-o(a,b)},r=function(a,b,c){return function(d){var e,f,g;for(e=f=0,g=a.length;g>=0?g>f:f>g;e=g>=0?++f:--f)if(!(d<a[e]))return(d/a[e]).toPrecision(c[Math.min(c.length-1,e)])+b[e];return d.toPrecision(c[c.length-1])+b[b.length-1]}},q=function(a,b){return function(c){var d,e,f;for(c+="",d=e=0,f=a.length;f>=0?f>e:e>f;d=f>=0?++e:--e)if(!(c.indexOf(b[d],c.length-b[d].length)<0))return+c.slice(0,c.length-b[d].length)*a[d];return parseFloat(c)}},n=r([1e15,1e12,1e9,1e6,1e3,1,.001,1e-6,1e-9,1e-12,1e-15],["E","T","G","M","k","","m","μ","n","p","f",""],[3]),i=q([1e15,1e12,1e9,1e6,1e3,.001,1e-6,1e-9,1e-12,1e-15,1],["E","T","G","M","k","m","μ","n","p","f",""]),p=r([31556952,604800,86400,3600,60,1,.001,1e-6,1e-9,1e-12],["y","w","d","h","m","s","ms","μs","ns","ps","s"],[2,2,2,2,2,3]),m=function(a){return(100*a).toPrecision(3)+"%"},a=function(a,b,c){var d,e,f,g,h,i,j,k;for(null==c&&(c=function(a){return a}),i=[0,a.length],h=i[0],d=i[1],e=Math.floor((h+d)/2),j=[c(a[e]),c(a[e+1])],f=j[0],g=j[1];!(b>f)||b>g;){if(b>g&&(h=e+1),b>f||(d=e),h>=d)return d;e=Math.floor((h+d)/2),k=[c(a[e]),c(a[e+1])],f=k[0],g=k[1]}return e+1},c=function(a){return a&&a.replace(/</g,"&lt;").replace(/>/g,"&gt;")},b=[],d=function(a,b){var c,d,e,f;return d=a.stringTable[b],e=d.lastIndexOf("("),f=d.lastIndexOf("/"),c=d.lastIndexOf(":"),e>=0&&f>e&&c>f?d.slice(0,e+1)+d.slice(f+1):0>e&&f>=0&&c>f?d.slice(f+1):d.replace("(<native>:0)","<native>")},l=function(a){return"js::RunScript"===a||"import <native>"===a},k=function(a,b){var c,d,e;return e=a.slider,d=b.trace.data[0][1],c=b.trace.data[b.trace.data.length-1][1],e.rangeSlider({bounds:{min:d,max:c},defaultValues:{min:d,max:2*(c-d)/3+d},range:{min:15*(c-d)/e.width()},formatter:function(a){return Math.round(a)+"ms"},valueLabels:"change"})},f=function(b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(p=b.table,m=a(c.trace.data,e.min,function(a){return null!=a?a[1]:void 0}),f=a(c.trace.data,e.max,function(a){return null!=a?a[1]:void 0}),l=[],i=[],o={},g=r=m;f>=m?f>r:r>f;g=f>=m?++r:--r)w=[q,c.trace.data[g][1]],k=w[0],q=w[1],h=d(c,c.trace.data[g][0]),j=h.length?l[l.length-1]:l.pop(),h.length&&l.push(h),null!=j&&(null!=o[j]?(h.length||o[j].count++,o[j].time+=q-k):(i.push(j),o[j]={count:h.length?0:1,time:q-k}));for(s=0,u=l.length;u>s;s++)h=l[s],o[h]&&o[h].count++;for(i.sort(function(a,b){return o[b].time-o[a].time}),p.empty(),g=t=0,v=i.length;v>t;g=++t)h=i[g],n=o[h],p.append($("<tr/>").append($("<td/>").text(h),$("<td/>").text(n.count),$("<td/>").text((n.time/n.count).toFixed(3)),$("<td/>").text(n.time.toFixed(3))));return $.bootstrapSortable()},h=function(c,e,f){var g,h,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba;for(I=c.plot,H=f.range.min,u=f.range.max-f.range.min,M=a(e.trace.data,H,function(a){return null!=a?a[1]:void 0}),v=a(e.trace.data,f.range.max,function(a){return null!=a?a[1]:void 0}),f.filter=f.filter&&f.filter.toLowerCase(),p=I.width(),k=I.height(),i=k/25,h=.8*i,o=4/p,g=parseFloat(I.css("fontSize")),m=5,j=1.5*h,n=4,s=I[0].getContext("2d"),s.font="1em sans-serif",s.textAlign="left",s.textBaseline="top",s.fillStyle="#fff",s.fillRect(0,0,p,k),D=[],s.beginPath(),_=e.markers.data,Q=0,U=_.length;U>Q;Q++)if(C=_[Q],z=C[0],N=C[1],t=C[2],!(H>N)){if(N>=H+u)break;if(z=e.stringTable[z],!(t&&("tracing"===(aa=t.type)||"GCMinor"===aa||"GCSlice"===aa||"DOMEvent"===aa)||z.startsWith("Bailout_")||z.startsWith("Navigation::"))){for(A=(N-H)/u*p,B=R=0,ba=D.length;ba>R&&!(D[B]<A);B=R+=1);for(;B>=D.length;)D.push(0);O=B*h+j,s.strokeStyle="#ccc",s.moveTo(A,O),s.lineTo(A,k),s.fillStyle="#888",s.fillText(z,A+m,O),G=s.measureText(z),D[B]=A+G.width+2*m}}for(s.stroke(),r=[],q=0,E=[],b=[],L=0,P=function(a){var c,d,e,f,l,m;return l=p*a.left,m=k-(a.top+1)*i,a.skip||j>m?void 0:(f=p*(a.right-a.left),d=h,c=chroma.hsl(222-222*Math.atan((a.multiplicity||0)/20)*2/Math.PI,.55,.55),a.marked||(e=c.lch(),e[1]=0,c=chroma.lch(e)),z=a.label,s.fillStyle=c.hex(),s.fillRect(l,m,f,d),s.strokeStyle=c.darken().hex(),s.strokeRect(l,m,f,d),!a.multiplicity&&f>4*o&&(G=s.measureText(z),G.width+2*o<=f&&(s.fillStyle="#fff",s.fillText(z,l+(f-G.width)/2,m+(d-g)/2))),b.push({left:l,right:l+f,top:m,bottom:m+d,label:z,labels:a.labels,multiplicity:a.multiplicity,duration:(a.right-a.left)*u}))},y=S=0;M>S;y=S+=1)if(z=d(e,e.trace.data[y][0]),K=l(z),z.length){for(;q>=r.length;)r.push(null);if(r[q]={label:z,left:0,right:0,top:q-L,marked:!f.filter,skip:K},f.filter&&z.toLowerCase().indexOf(f.filter)>=0)for(T=0,V=r.length;V>T;T++)w=r[T],w.marked=!0;q++,K&&L++}else q=Math.max(q-1,0),q>=0&&r[q].skip&&L--;for(y=Y=M;v>Y;y=Y+=1)if(z=d(e,e.trace.data[y][0]),K=l(z),J=(e.trace.data[y][1]-H)/u,z.length){for(;q>=r.length;)r.push(null);if(r[q]={label:z,left:J,right:0,top:q-L,marked:!f.filter,skip:K},f.filter&&z.toLowerCase().indexOf(f.filter)>=0)for(Z=0,W=r.length;W>Z;Z++)w=r[Z],w.marked=!0;q++,K&&L++}else if(q)if(q--,x=r[q],x.right=J,x.skip&&L--,J-x.left<o){for(;x.top>=E.length;)E.push(null);if(F=E[x.top],x.left-(null!=F?F.right:void 0)<o){F.right=J,F.multiplicity=(F.multiplicity||1)+1,F.labels[x.label]=(F.labels[x.label]||0)+1,F.marked=F.marked||x.marked,F.skip=!1;continue}F&&F.right-F.left>=o&&P(F),x.labels={},x.labels[x.label]=1,E[x.top]=x}else P(x);for($=0,X=E.length;X>$;$++)F=E[$],F&&F.right-F.left>=o&&P(F);for(;q-->0;)x=r[q],x.right=1,P(x);return b.sort(function(a,b){return a.right-b.right})},e=function(d){var e,g,i,j,l,m,n;return g={container:$(".traceview .plot-container"),plot:$(".traceview .plot"),tooltip:$(".traceview .tooltip"),marker:$(".traceview .marker"),timestamp:$(".traceview .marker .timestamp"),slider:$(".traceview .slider"),table:$(".stats tbody"),filter:$(".filter")},g.plot.attr("width",g.slider.width()),g.marker.height(g.plot.height()),e=null,k(g,d),n={range:g.slider.rangeSlider("values"),filter:g.filter.val()},h(g,d,n),g.slider.on("valuesChanging",function(a,b){return window.requestAnimationFrame(function(){return e=null,g.marker.hide(),n.range=b.values,h(g,d,n)})}),g.filter.on("input",function(a){return window.requestAnimationFrame(function(){return n.filter=g.filter.val(),h(g,d,n)})}),f(g,d,n.range),g.slider.on("valuesChanged",function(a,b){return n.range=b.values,f(g,d,n.range)}),j=function(d){var f,h,i,j,k,l,m,n,o,q,r,s,t,u,v,w;if(f=10,o=g.plot.offset(),v=[d.pageX-o.left,d.pageY-o.top],s=v[0],t=v[1],r=a(b,s,function(a){return null!=a?a.right:void 0}),q=g.slider.rangeSlider("values"),e&&!e.stopped)return h=Math.abs(d.pageX-e.x),g.timestamp.text("<"+p(h/g.plot.width()*(q.max-q.min)/1e3)+">"),g.marker.removeClass("zoomin").width(Math.max(1,h)),void g.marker.offset({left:Math.min(d.pageX,e.x),top:o.top});if(e&&e.stopped){if(g.marker.addClass("zoomin"),n=g.marker.offset(),d.pageX>n.left&&d.pageX<n.left+g.marker.width())return void g.tooltip.hide()}else g.timestamp.text(""+Math.round(s/g.plot.width()*(q.max-q.min)+q.min)+"ms"),g.marker.removeClass("zoomin").width(1).show().offset({left:d.pageX,top:o.top});for(j=u=r,w=b.length;w>u;j=u+=1)if(i=b[j],!(s<=i.left||t<=i.top||t>i.bottom))return i.labels?(l=""+i.multiplicity+" labels:<br><br>",m=Object.keys(i.labels),m.sort(function(a,b){return i.labels[b]-i.labels[a]}),l+=function(){var a,b,d,e;for(d=m.slice(0,3),e=[],a=0,b=d.length;b>a;a++)k=d[a],e.push(""+i.labels[k]+" &times; "+(""+c(k)+"<br>"));return e}().join("")):l=c(i.label),l+="<br>spanning "+p(i.duration/1e3),g.tooltip.children(".tooltip-inner").html(l),void g.tooltip.show().offset({left:Math.max(f,Math.min(g.plot.width()-g.tooltip.width(),o.left+(i.right+i.left-g.tooltip.width())/2)),top:o.top+i.top-g.tooltip.height()-f});return g.tooltip.hide()},l=function(a){return g.tooltip.hide(),e?void(e.stopped=!0):g.marker.hide()},i=function(a){var b,c,d,f,h,i,k;if(!g.tooltip.is(":visible"))return b=g.marker.offset(),c=g.marker.width(),(null!=e?e.stopped:void 0)&&a.pageX>b.left&&a.pageX<b.left+c?(h=g.plot.offset(),i=g.plot.width(),k=g.slider.rangeSlider("values"),e=null,f=function(a){return(a-h.left)/i*(k.max-k.min)+k.min},d={min:f(b.left),max:f(b.left+c)},g.slider.rangeSlider("values",d.min,d.max),g.slider.trigger("valuesChanging",{values:d}),g.slider.trigger("valuesChanged",{values:d}),void j(a)):(e={x:a.pageX,y:a.pageY},j(a),a.preventDefault())},m=function(a){return e?Math.abs(a.pageX-e.x)<2&&Math.abs(a.pageY-e.y)<2?(e=null,void j(a)):e.stopped=!0:void 0},g.container.mousemove(j),g.container.mouseleave(l),g.container.mousedown(i),g.container.mouseup(m)},$(function(){var a;return a=$("#tracefile"),a.change(function(){return $.getJSON(a.val()).done(function(a){return e(a.threads[0])})}),a.trigger("change")})}).call(this);